---
phase: 01-github-action-foundation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - dist/index.js
  - dist/licenses.txt
  - package.json
  - action.yml
autonomous: true
must_haves:
  truths:
    - "Action code is bundled into single dist/index.js file"
    - "action.yml uses node24 runtime explicitly"
    - "Bundle includes all dependencies from @actions/core and @actions/github"
    - "Licenses are bundled in dist/licenses.txt"
  artifacts:
    - path: "dist/index.js"
      provides: "Bundled action code ready for execution"
      min_lines: 5000
    - path: "dist/licenses.txt"
      provides: "License compliance for bundled dependencies"
    - path: "action.yml"
      provides: "Action runtime configuration"
      contains: "using: 'node24'"
    - path: "package.json"
      provides: "Build scripts for bundling"
      contains: '"build": "ncc build src/index.js --license licenses.txt"'
  key_links:
    - from: "package.json scripts.build"
      to: "dist/index.js"
      via: "ncc build command"
      pattern: "ncc build src/index.js"
    - from: "action.yml runs.using"
      to: "Node.js 24.x runtime"
      via: "GitHub Actions runtime specification"
      pattern: "using: 'node24'"
---

<objective>
Bundle the action code with @vercel/ncc and configure Node.js 24.x runtime for execution.

Purpose: Create a distributable single-file bundle that can be executed by GitHub Actions, and explicitly set the runtime to Node.js 24.x as required by WORK-03.
Output: Bundled dist/index.js, licenses.txt, updated package.json with build script, and action.yml configured for node24.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/STATE.md

@.planning/phases/01-github-action-foundation/01-RESEARCH.md
@.planning/phases/01-github-action-foundation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Add build script and bundle with ncc</name>
  <files>package.json, dist/index.js, dist/licenses.txt</files>
  <action>
    1. Read existing package.json (created in Plan 01)
    2. Add build script to package.json scripts section:
       ```json
       "scripts": {
         "build": "ncc build src/index.js --license licenses.txt"
       }
       ```
    3. Run the bundler: `npm run build` or `npx ncc build src/index.js --license licenses.txt`
    4. Verify dist/index.js and dist/licenses.txt are created
    5. Verify dist/index.js contains bundled code (should be large, ~5000+ lines)

    Do NOT modify any other files or scripts beyond adding the build script.
    Use the exact command: `ncc build src/index.js --license licenses.txt` (matching RESEARCH.md Pattern 4).
  </action>
  <verify>
    `test -f dist/index.js && test -f dist/licenses.txt && grep -q "node_modules" dist/index.js && wc -l < dist/index.js | grep -qE "^[0-9]{4,}"` returns 0
  </verify>
  <done>
    dist/index.js exists and contains bundled code (5000+ lines), dist/licenses.txt contains dependency licenses
  </done>
</task>

<task type="auto">
  <name>Configure Node.js 24.x runtime in action.yml</name>
  <files>action.yml</files>
  <action>
    1. Read existing action.yml (created in Plan 01)
    2. Verify the runs.using field is set to 'node24' EXACTLY
    3. If runs.using is missing or not 'node24', update it to:
       ```yaml
       runs:
         using: 'node24'
         main: 'dist/index.js'
       ```

    The action.yml from Plan 01 should already have this set, but this task verifies and ensures it's correct.
    Use EXACTLY 'node24' (not 'node20', 'node16', etc.) to satisfy WORK-03 requirement.
  </action>
  <verify>
    `grep -q "using: 'node24'" action.yml` returns 0
  </verify>
  <done>
    action.yml has runs.using set to 'node24' explicitly
  </done>
</task>

</tasks>

<verification>
- dist/index.js exists and contains bundled code (large file, 5000+ lines)
- dist/licenses.txt exists with license text from bundled dependencies
- package.json contains build script using ncc
- action.yml has runs.using: 'node24'
- Bundled code can be executed by GitHub Actions
</verification>

<success_criteria>
- Action is successfully bundled into dist/index.js
- Licenses are tracked in dist/licenses.txt
- Runtime is explicitly configured for Node.js 24.x
- Build process is repeatable via npm run build
</success_criteria>

<output>
After completion, create `.planning/phases/01-github-action-foundation/01-02-SUMMARY.md`
</output>
