---
phase: 01-github-action-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - package-lock.json
  - action.yml
  - src/index.js
autonomous: true
must_haves:
  truths:
    - "Node.js project structure exists with @actions/core, @actions/github, and @vercel/ncc installed"
    - "action.yml defines four required inputs: issue-number, repo-owner, repo-name, comment-body"
    - "src/index.js imports @actions/core and @actions/github and reads inputs using core.getInput()"
    - "Entry point has try/catch structure with core.setFailed() for error handling"
  artifacts:
    - path: "package.json"
      provides: "Node.js project configuration and dependencies"
      contains: "@actions/core", "@actions/github", "@vercel/ncc"
    - path: "action.yml"
      provides: "Action metadata and interface"
      contains: "inputs:", "issue-number", "repo-owner", "repo-name", "comment-body"
    - path: "src/index.js"
      provides: "Action entry point"
      min_lines: 20
  key_links:
    - from: "action.yml"
      to: "src/index.js"
      via: "runs.main field references dist/index.js (after bundle)"
      pattern: "main: 'dist/index.js'"
    - from: "src/index.js"
      to: "@actions/core"
      via: "import statement for input/output handling"
      pattern: "import.*from '@actions/core'"
---

<objective>
Create the foundational GitHub Action structure with Node.js project, action metadata, and basic entry point.

Purpose: Establish the minimum viable action structure that defines the interface (inputs) and provides a working entry point ready for bundling.
Output: Initialized Node.js project, action.yml metadata, and src/index.js entry point.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/STATE.md

@.planning/phases/01-github-action-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Initialize Node.js project and install dependencies</name>
  <files>package.json, package-lock.json, src/</files>
  <action>
    Initialize Node.js project:
    1. Run `npm init -y` to create package.json
    2. Create src/ directory with `mkdir -p src`
    3. Install dependencies:
       - Runtime: `npm install @actions/core @actions/github`
       - Dev: `npm install --save-dev @vercel/ncc`
    4. Update package.json name to "gsd-github-action" (or appropriate based on project)
    5. Add type: "module" to package.json for ES module support (optional but recommended)

    Do NOT modify any other files.
  </action>
  <verify>
    `test -f package.json && test -f package-lock.json && test -d src && npm ls @actions/core @actions/github @vercel/ncc` returns 0
  </verify>
  <done>
    package.json and package-lock.json exist with @actions/core, @actions/github, and @vercel/ncc installed; src/ directory created
  </done>
</task>

<task type="auto">
  <name>Create action.yml metadata</name>
  <files>action.yml</files>
  <action>
    Create action.yml file with the following structure based on RESEARCH.md Pattern 1:

    ```yaml
    name: 'GSD GitHub Action'
    description: 'Processes GSD commands in issue comments'

    inputs:
      issue-number:
        description: 'The issue or PR number'
        required: true
      repo-owner:
        description: 'The repository owner'
        required: true
      repo-name:
        description: 'The repository name'
        required: true
      comment-body:
        description: 'The comment body text'
        required: true

    outputs:
      response-posted:
        description: 'Whether the response was successfully posted'

    runs:
      using: 'node24'
      main: 'dist/index.js'
    ```

    Use EXACTLY these input names: issue-number, repo-owner, repo-name, comment-body (matching WORK-01 requirements).
    Set main to 'dist/index.js' (will be created by bundling in Plan 02).
  </action>
  <verify>
    `test -f action.yml && grep -q "issue-number" action.yml && grep -q "repo-owner" action.yml && grep -q "repo-name" action.yml && grep -q "comment-body" action.yml` returns 0
  </verify>
  <done>
    action.yml exists with all four required inputs defined and runs.main pointing to dist/index.js
  </done>
</task>

<task type="auto">
  <name>Create src/index.js entry point</name>
  <files>src/index.js</files>
  <action>
    Create src/index.js with basic entry point following RESEARCH.md Pattern 3:

    ```javascript
    import * as core from "@actions/core";
    import * as github from "@actions/github";

    try {
      // Get inputs from action.yml
      const issueNumber = core.getInput("issue-number");
      const repoOwner = core.getInput("repo-owner");
      const repoName = core.getInput("repo-name");
      const commentBody = core.getInput("comment-body");

      core.info(`Processing command for issue ${issueNumber} in ${repoOwner}/${repoName}`);
      core.info(`Comment body: ${commentBody}`);

      // TODO: Parse command and execute logic in later phases

      // Set output
      core.setOutput("response-posted", "true");

      // Clean exit - no explicit return needed
    } catch (error) {
      // Set failed exit code
      core.setFailed(`Action failed: ${error.message}`);
    }
    ```

    Key requirements:
    - Import @actions/core and @actions/github
    - Read all four inputs using core.getInput()
    - Use core.info() for logging
    - Use try/catch with core.setFailed() for error handling
    - Set output "response-posted" to "true"
    - DO NOT add command parsing logic yet (that's Phase 2)
  </action>
  <verify>
    `test -f src/index.js && grep -q "import.*from '@actions/core'" src/index.js && grep -q "import.*from '@actions/github'" src/index.js` returns 0
  </verify>
  <done>
    src/index.js exists, imports required packages, reads all four inputs, and has proper error handling structure
  </done>
</task>

</tasks>

<verification>
- package.json contains @actions/core, @actions/github (runtime) and @vercel/ncc (dev)
- action.yml defines all four required inputs (issue-number, repo-owner, repo-name, comment-body)
- src/index.js imports @actions/core and @actions/github
- src/index.js uses core.getInput() for each input
- src/index.js has try/catch with core.setFailed()
- All files are in the repository root (action.yml, package.json, src/)
</verification>

<success_criteria>
- Node.js project initialized with all dependencies installed
- action.yml defines the action interface with four required inputs
- src/index.js is a working entry point that reads inputs and has proper error handling
- Ready for bundling in Plan 02
</success_criteria>

<output>
After completion, create `.planning/phases/01-github-action-foundation/01-01-SUMMARY.md`
</output>
